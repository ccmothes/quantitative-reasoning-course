<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 5 Introduction to Statistics | Quantitative Reasoning for Ecosystem Science</title>
  <meta name="description" content="This site hosts the course lab content for ESS 330 at Colorado State University." />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content=" 5 Introduction to Statistics | Quantitative Reasoning for Ecosystem Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This site hosts the course lab content for ESS 330 at Colorado State University." />
  <meta name="github-repo" content="ccmothes/quantitative-reasoning-course" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 5 Introduction to Statistics | Quantitative Reasoning for Ecosystem Science" />
  
  <meta name="twitter:description" content="This site hosts the course lab content for ESS 330 at Colorado State University." />
  

<meta name="author" content="Caitlin C. Mothes, PhD" />


<meta name="date" content="2023-04-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exploratory-data-analysis.html"/>
<link rel="next" href="multivariate-statistics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="libs/tabwid-1.1.2/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Reasoning for Ecosystem Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#set-up-instructions"><i class="fa fa-check"></i>Set up Instructions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#navigating-this-site"><i class="fa fa-check"></i>Navigating this site</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="setup-instructions.html"><a href="setup-instructions.html"><i class="fa fa-check"></i><b>2</b> Setup Instructions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="setup-instructions.html"><a href="setup-instructions.html#install-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> Install R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="setup-instructions.html"><a href="setup-instructions.html#package-installation"><i class="fa fa-check"></i><b>2.2</b> Package Installation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>3</b> Introduction to R and RStudio</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#getting-to-know-rstudio"><i class="fa fa-check"></i><b>3.1</b> Getting to know RStudio</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#r-projects"><i class="fa fa-check"></i><b>3.2</b> R Projects</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#write-your-first-script"><i class="fa fa-check"></i><b>3.3</b> Write your first script</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#commenting-code"><i class="fa fa-check"></i><b>3.3.1</b> Commenting code</a></li>
<li class="chapter" data-level="3.3.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#executing-code"><i class="fa fa-check"></i><b>3.3.2</b> Executing code</a></li>
<li class="chapter" data-level="3.3.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#getting-help-with-code"><i class="fa fa-check"></i><b>3.3.3</b> Getting help with code</a></li>
<li class="chapter" data-level="3.3.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#functions"><i class="fa fa-check"></i><b>3.3.4</b> Functions</a></li>
<li class="chapter" data-level="3.3.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#data-types"><i class="fa fa-check"></i><b>3.3.5</b> Data Types</a></li>
<li class="chapter" data-level="3.3.6" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#indexing"><i class="fa fa-check"></i><b>3.3.6</b> Indexing</a></li>
<li class="chapter" data-level="3.3.7" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#read-and-write-data"><i class="fa fa-check"></i><b>3.3.7</b> Read and Write Data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#exercises"><i class="fa fa-check"></i><b>3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>4</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-wrangling"><i class="fa fa-check"></i><b>4.1</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#the-dplyr-package"><i class="fa fa-check"></i><b>4.1.1</b> The <code>dplyr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#visualization"><i class="fa fa-check"></i><b>4.2</b> Visualization</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exercises-1"><i class="fa fa-check"></i><b>4.2.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html"><i class="fa fa-check"></i><b>5</b> Introduction to Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#explore-the-dataset"><i class="fa fa-check"></i><b>5.1</b> Explore the dataset</a></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#chi-square---categorical-analysis"><i class="fa fa-check"></i><b>5.2</b> Chi-square - Categorical Analysis</a></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#t-test---compare-two-means"><i class="fa fa-check"></i><b>5.3</b> t-test - Compare two means</a></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#correlation---assess-relationships"><i class="fa fa-check"></i><b>5.4</b> Correlation - Assess relationships</a></li>
<li class="chapter" data-level="5.5" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#exercises-2"><i class="fa fa-check"></i><b>5.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#acknowledgements"><i class="fa fa-check"></i><b>5.5.1</b> Acknowledgements</a></li>
<li class="chapter" data-level="5.5.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#citations"><i class="fa fa-check"></i><b>5.5.2</b> Citations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html"><i class="fa fa-check"></i><b>6</b> Multivariate Statistics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#explore-the-data-set"><i class="fa fa-check"></i><b>6.1</b> Explore the Data set</a></li>
<li class="chapter" data-level="6.2" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#anova"><i class="fa fa-check"></i><b>6.2</b> ANOVA</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#assumptions"><i class="fa fa-check"></i><b>6.2.1</b> Assumptions</a></li>
<li class="chapter" data-level="6.2.2" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#post-hoc-tukeys-hsd-test"><i class="fa fa-check"></i><b>6.2.2</b> Post-hoc Tukey’s HSD test</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#simple-linear-regression"><i class="fa fa-check"></i><b>6.3</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="6.4" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#multiple-linear-regression"><i class="fa fa-check"></i><b>6.4</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="6.5" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#exercises-3"><i class="fa fa-check"></i><b>6.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#acknowledgements-1"><i class="fa fa-check"></i><b>6.5.1</b> Acknowledgements</a></li>
<li class="chapter" data-level="6.5.2" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#citations-1"><i class="fa fa-check"></i><b>6.5.2</b> Citations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html"><i class="fa fa-check"></i><b>7</b> PCA and R Markdown Intro</a>
<ul>
<li class="chapter" data-level="7.1" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#intro-to-r-markdown"><i class="fa fa-check"></i><b>7.1</b> Intro to R Markdown</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#getting-started-with-r-markdown"><i class="fa fa-check"></i><b>7.1.1</b> Getting started with R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#principal-component-analysis-pca"><i class="fa fa-check"></i><b>7.2</b> Principal Component Analysis (PCA)</a></li>
<li class="chapter" data-level="7.3" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#variance-explained"><i class="fa fa-check"></i><b>7.3</b> Variance explained</a></li>
<li class="chapter" data-level="7.4" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#variable-loadings"><i class="fa fa-check"></i><b>7.4</b> Variable loadings</a></li>
<li class="chapter" data-level="7.5" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#visualize-patterns"><i class="fa fa-check"></i><b>7.5</b> Visualize patterns</a></li>
<li class="chapter" data-level="7.6" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#a-note-on-rendering"><i class="fa fa-check"></i><b>7.6</b> A Note on Rendering:</a></li>
<li class="chapter" data-level="7.7" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#exercises-4"><i class="fa fa-check"></i><b>7.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html"><i class="fa fa-check"></i><b>8</b> Introduction to Spatial Data in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#set-up"><i class="fa fa-check"></i><b>8.1</b> Set Up</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#package-installation-1"><i class="fa fa-check"></i><b>8.1.1</b> Package Installation</a></li>
<li class="chapter" data-level="8.1.2" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#data-download"><i class="fa fa-check"></i><b>8.1.2</b> Data download</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#spatial-data-formats"><i class="fa fa-check"></i><b>8.2</b> Spatial Data Formats</a></li>
<li class="chapter" data-level="8.3" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#import-and-manipulate-spatial-data"><i class="fa fa-check"></i><b>8.3</b> Import and manipulate spatial data</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#vector-data"><i class="fa fa-check"></i><b>8.3.1</b> Vector Data</a></li>
<li class="chapter" data-level="8.3.2" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>8.3.2</b> Coordinate Reference Systems</a></li>
<li class="chapter" data-level="8.3.3" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#raster-data"><i class="fa fa-check"></i><b>8.3.3</b> Raster Data</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#reading-and-writing-spatial-data"><i class="fa fa-check"></i><b>8.4</b> Reading and Writing Spatial Data</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#writing-spatial-data"><i class="fa fa-check"></i><b>8.4.1</b> Writing spatial data</a></li>
<li class="chapter" data-level="8.4.2" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#reading-spatial-data"><i class="fa fa-check"></i><b>8.4.2</b> Reading Spatial Data</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#before-rendering"><i class="fa fa-check"></i><b>8.5</b> Before Rendering!</a></li>
<li class="chapter" data-level="8.6" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#exercises-5"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html"><i class="fa fa-check"></i><b>9</b> Data Visualization in R</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#data-preparation"><i class="fa fa-check"></i><b>9.0.1</b> Data Preparation</a></li>
<li class="chapter" data-level="9.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#publication-ready-figures-with-ggplot2"><i class="fa fa-check"></i><b>9.1</b> Publication Ready Figures with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#general-appearance"><i class="fa fa-check"></i><b>9.1.1</b> General Appearance</a></li>
<li class="chapter" data-level="9.1.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#color-size-and-legends"><i class="fa fa-check"></i><b>9.1.2</b> Color, Size and Legends</a></li>
<li class="chapter" data-level="9.1.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#annotation"><i class="fa fa-check"></i><b>9.1.3</b> Annotation</a></li>
<li class="chapter" data-level="9.1.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#finalize-and-save"><i class="fa fa-check"></i><b>9.1.4</b> Finalize and save</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#publication-ready-maps-with-tmap"><i class="fa fa-check"></i><b>9.2</b> Publication Ready Maps with <code>tmap</code></a></li>
<li class="chapter" data-level="9.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#publication-ready-tables-with-flextable"><i class="fa fa-check"></i><b>9.3</b> Publication Ready Tables with <code>flextable</code></a></li>
<li class="chapter" data-level="9.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#the-assignment"><i class="fa fa-check"></i><b>9.4</b> The Assignment</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#acknowledgements-and-resources"><i class="fa fa-check"></i><b>9.4.1</b> Acknowledgements and Resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="working-with-qualitative-data-in-r.html"><a href="working-with-qualitative-data-in-r.html"><i class="fa fa-check"></i><b>10</b> Working with Qualitative Data in R</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="working-with-qualitative-data-in-r.html"><a href="working-with-qualitative-data-in-r.html#is-science-objective"><i class="fa fa-check"></i><b>10.0.1</b> Is Science Objective?</a></li>
<li class="chapter" data-level="10.0.2" data-path="working-with-qualitative-data-in-r.html"><a href="working-with-qualitative-data-in-r.html#what-are-the-pros-and-cons-of-open-science"><i class="fa fa-check"></i><b>10.0.2</b> What are the pros and cons of open science?</a></li>
<li class="chapter" data-level="10.0.3" data-path="working-with-qualitative-data-in-r.html"><a href="working-with-qualitative-data-in-r.html#contribute-to-equity-and-environmental-justice"><i class="fa fa-check"></i><b>10.0.3</b> Contribute to Equity and Environmental Justice</a></li>
<li class="chapter" data-level="10.1" data-path="working-with-qualitative-data-in-r.html"><a href="working-with-qualitative-data-in-r.html#more-resources"><i class="fa fa-check"></i><b>10.1</b> More Resources</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Reasoning for Ecosystem Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-statistics" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number"> 5</span> Introduction to Statistics<a href="introduction-to-statistics.html#introduction-to-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this lesson you will be introduced to the process of conducting statistical tests in R, specifically chi-square, t-tests, and correlation tests.</p>
<p>First, to access the dataset(s) you will be using today install the <code>remotes</code> package, and then install the <code>lterdatasampler</code> package (<code>remotes</code> is needed because <code>lterdatasampler</code> has to be installed from GitHub as opposed to CRAN).</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="introduction-to-statistics.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;remotes&quot;</span>)</span>
<span id="cb45-2"><a href="introduction-to-statistics.html#cb45-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;lter/lterdatasampler&quot;</span>)</span></code></pre></div>
<p>Now load in all libraries needed for this lesson:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="introduction-to-statistics.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb46-2"><a href="introduction-to-statistics.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lterdatasampler)</span></code></pre></div>
<p>Then run the following line of code to retrieve the <code>and_vertebrates</code> data set and bring it into your R session:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="introduction-to-statistics.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(and_vertebrates)</span></code></pre></div>
<div id="explore-the-dataset" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Explore the dataset<a href="introduction-to-statistics.html#explore-the-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Do a little exploration of this data first to understand its structure, variables and data types:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="introduction-to-statistics.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the data structure</span></span>
<span id="cb48-2"><a href="introduction-to-statistics.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(and_vertebrates)</span>
<span id="cb48-3"><a href="introduction-to-statistics.html#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="introduction-to-statistics.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore the metadata in the Help pane</span></span>
<span id="cb48-5"><a href="introduction-to-statistics.html#cb48-5" aria-hidden="true" tabindex="-1"></a>?and_vertebrates</span></code></pre></div>
<p>This data set contains length and weight observations for three aquatic species in clear cut and old growth coniferous forest sections of Mack Creek in HJ Andrews Experimental Forest in Oregon. The three species are <strong>Cutthroat trout</strong>, <strong>Coastal giant salamander</strong> and <strong>Cascade torrent salamander</strong>.</p>
</div>
<div id="chi-square---categorical-analysis" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Chi-square - Categorical Analysis<a href="introduction-to-statistics.html#chi-square---categorical-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When you are working with two categorical variables, the statistical test you would use is a Chi-square test. This test can tell you if there is a relationship between your two categorical variables.</p>
<p>For example, we have two categorical variables in the <code>and_vertebrates</code> data set:</p>
<ul>
<li><p><code>section</code> = two forest sections, clear cut (CC) and old growth (OG)</p></li>
<li><p><code>unittype</code> = channel unit classification type (C = cascade, I = riffle, IP = isolated pool (not connected to channel), P = pool, R = rapid, S = step (small falls), SC = side channel, NA = not sampled by unit)</p></li>
</ul>
<p>Lets focus this question on Cutthroat trout. First explore the abundance of cutthroat trout in different channel types, using the <code>n()</code> function to return the total count/number of observations in each group.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="introduction-to-statistics.html#cb49-1" aria-hidden="true" tabindex="-1"></a>and_vertebrates <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="introduction-to-statistics.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">&quot;Cutthroat trout&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="introduction-to-statistics.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(unittype) <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="introduction-to-statistics.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">abundance =</span> <span class="fu">n</span>())</span></code></pre></div>
<p>This output tells us that there are quite a few observations with the <code>NA</code> category, meaning channel type was unknown or not recroded. Let’s edit the workflow above slightly, using two new functions: <code>drop_na()</code> and <code>count()</code>. <code>drop_na()</code> will remove any rows within a specified column (or columns) that have NA values, and we can use <code>count()</code> as an alternative to <code>group_by()</code> and <code>summarise()</code> when we just want number of observations for a single variable (in this case <code>unittype</code>).</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="introduction-to-statistics.html#cb50-1" aria-hidden="true" tabindex="-1"></a>and_vertebrates <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="introduction-to-statistics.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">&quot;Cutthroat trout&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="introduction-to-statistics.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(unittype) <span class="sc">%&gt;%</span> </span>
<span id="cb50-4"><a href="introduction-to-statistics.html#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(unittype)</span></code></pre></div>
<p>This returns just about the same data frame as the first method, but now with the NA category removed because it dropped any observations that were <code>NA</code> for <code>unittype</code>.</p>
<p>From this we also observe that the highest Cutthroat trout abundances are found in cascade (C), pool (P), and side channel (SC) habitats.</p>
<p>Now, our question expands beyond this one categorical variable (channel type) and we want to know if abundance is affected by both channel and and forest type (<code>section</code>). Here, <em>our null hypothesis is that forest and channel type are independent</em>. To test this, we use the <code>chisq.test()</code> function to carry out a chi-square test, but first we have to reformat our data into a <strong>contingency table</strong>.</p>
<p>A contingency table is in matrix format, where each cell is the frequency (in this case seen as abundance) of Cutthroat trout in each combination of categorical variables (forest type and channel unit). We can create a contingency table with the <code>table()</code> function. For this analysis, lets also filter out just the 3 most abundant unit types for Cutthroat trout (C, P and SC).</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="introduction-to-statistics.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First clean the dataset to create the contingency table from</span></span>
<span id="cb51-2"><a href="introduction-to-statistics.html#cb51-2" aria-hidden="true" tabindex="-1"></a>trout_clean <span class="ot">&lt;-</span> and_vertebrates <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="introduction-to-statistics.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter Cutthroat trout</span></span>
<span id="cb51-4"><a href="introduction-to-statistics.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">&quot;Cutthroat trout&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-5"><a href="introduction-to-statistics.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lets test using just the 3 most abundant unittypes</span></span>
<span id="cb51-6"><a href="introduction-to-statistics.html#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unittype <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;SC&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-7"><a href="introduction-to-statistics.html#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># drop NAs for both unittype and section</span></span>
<span id="cb51-8"><a href="introduction-to-statistics.html#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(unittype, section)</span>
<span id="cb51-9"><a href="introduction-to-statistics.html#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="introduction-to-statistics.html#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="introduction-to-statistics.html#cb51-11" aria-hidden="true" tabindex="-1"></a>cont_table <span class="ot">&lt;-</span> <span class="fu">table</span>(trout_clean<span class="sc">$</span>section, trout_clean<span class="sc">$</span>unittype)</span></code></pre></div>
<p>To execute the Chi-square test does not take that much code, but it is important to note that by default, <code>chisq.test()</code> assumes the null hypothesis is that all frequencies have equal probability. If you have different pre-conceived frequency probabilities for your data you have to define those within the <code>chisq.test()</code> function.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="introduction-to-statistics.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(cont_table)</span></code></pre></div>
<p>Looking at these results, we have an extremely small p-value. This tells us that there <em>is</em> a significant relationship between forest type and channel unit (i.e., we rejected our null hypothesis).</p>
<p>Lets look at the abundance distribution visually:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="introduction-to-statistics.html#cb53-1" aria-hidden="true" tabindex="-1"></a>trout_clean <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="introduction-to-statistics.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(unittype, section) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="introduction-to-statistics.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> unittype, <span class="at">y =</span> n))<span class="sc">+</span></span>
<span id="cb53-4"><a href="introduction-to-statistics.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> section))<span class="sc">+</span></span>
<span id="cb53-5"><a href="introduction-to-statistics.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>))<span class="sc">+</span></span>
<span id="cb53-6"><a href="introduction-to-statistics.html#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</div>
<div id="t-test---compare-two-means" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> t-test - Compare two means<a href="introduction-to-statistics.html#t-test---compare-two-means" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Previous work has shown that forest harvesting can impact aquatic vertebrate biomass (Kaylor &amp; Warren 2017). With this <code>and_vertebrates</code> data set we can investigate this hypothesis, by comparing weight to forest type (clear cut or old growth). This therefore involves a test comparing the means (average weight) among two groups (clear cut and old growth forests), which then requires a t-test.</p>
<p>Lets focus on conducting this test for just Cutthroat trout (to reduce species-level variances in weight), so we can use the same <code>trout_clean</code> data set we made earlier, but let’s also drop all NAs in <code>weight_g</code>. Then, lets first visualize the differences in weight among forest type with a boxplot:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="introduction-to-statistics.html#cb54-1" aria-hidden="true" tabindex="-1"></a>trout_clean <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="introduction-to-statistics.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(weight_g) <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="introduction-to-statistics.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> section, <span class="at">y =</span> weight_g))<span class="sc">+</span></span>
<span id="cb54-4"><a href="introduction-to-statistics.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p>We don’t see too much of a difference based on this visual, but lets conduct the statistical test to really verify if our hypothesis is supported.</p>
<p>First however we need to check our test assumptions, which for t-tests assumes the variance of the groups is equal. We can test for equal variances with the function <code>var.test()</code>, where the <em>null</em> hypothesis is that the variances is equal. In this step we need two vectors of the weights in each separate forest section. You can use <code>pull()</code> to convert a single column of a data frame/tibble to a vector, and we want to do this for clear cut and old growth forests separately. We then put both of those vectors in the <code>var.test()</code> function to assess their equal variances.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="introduction-to-statistics.html#cb55-1" aria-hidden="true" tabindex="-1"></a>cc_weight <span class="ot">&lt;-</span> trout_clean <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="introduction-to-statistics.html#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section <span class="sc">==</span> <span class="st">&quot;CC&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="introduction-to-statistics.html#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(weight_g)</span>
<span id="cb55-4"><a href="introduction-to-statistics.html#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="introduction-to-statistics.html#cb55-5" aria-hidden="true" tabindex="-1"></a>og_weight <span class="ot">&lt;-</span> trout_clean <span class="sc">%&gt;%</span> </span>
<span id="cb55-6"><a href="introduction-to-statistics.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section <span class="sc">==</span> <span class="st">&quot;OG&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-7"><a href="introduction-to-statistics.html#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(weight_g)</span>
<span id="cb55-8"><a href="introduction-to-statistics.html#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="introduction-to-statistics.html#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(cc_weight, og_weight)</span></code></pre></div>
<p>Looks like our variances are not equal. We have two options now, we can either transform our weight variable or use the Welch t-test which does not assume equal variances.</p>
<p><strong>Variable transformation</strong></p>
<p>If we look at the distribution of weight (our continuous variable), it is pretty right skewed. Therefore, we’d likely want to do a log transformation on the data, which works well the data is skewed like this:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="introduction-to-statistics.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(trout_clean<span class="sc">$</span>weight_g)</span></code></pre></div>
<p>Lets perform the variances check like we did before, but on the log transformed values, which you can do with <code>log</code></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="introduction-to-statistics.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(<span class="fu">log</span>(cc_weight), <span class="fu">log</span>(og_weight))</span></code></pre></div>
<p>Now we have a high p-value, indicating support for the null that the variances are equal. So. we can use the default <code>t.test()</code> test which assumes equal variances, but on a log transformed weight variable.</p>
<p>The <code>t.test()</code> function in R takes in your dependent (in our case trout weight) and independent (forest type) variables as vectors (instead of just column names like you can do in the Tidyverse). Remember how we can index single columns of data frames with the <code>$</code> operator. The order of the variables in the <code>t.test()</code> function is {dependent variable} ~ {independent variable}. We use the <code>~</code> to specify a model, telling the test we want to know if weight <em>varies by</em> forest section.</p>
<p>Remember we also want to log transform the weight values and then specify that our variances are equal since we confirmed that with <code>var.test()</code> above, so the final <code>t.test()</code> call would be this:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="introduction-to-statistics.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">log</span>(trout_clean<span class="sc">$</span>weight_g) <span class="sc">~</span> trout_clean<span class="sc">$</span>section, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The output of this test gives us the test statistics, p-value, and the means for each of our forest groups. Given the p-value of 0.0043, we can conclude that we reject the null hypothesis that mean Cutthroat weight is the same in clear cut and old growth forest sections, and looking at our results (specifically the means) we can conclude that <em>Cutthroat trout weight was observed to be significantly higher in clear cut forests compared to old growth forests</em>. Remember though that now these mean weight values are log transformed, and not the raw weight in grams. The relationship can still be interpreted the same.</p>
<p>How does this relate to your original hypothesis?</p>
<p><strong>Welch Two Sample t-test</strong></p>
<p>Alternatively, instead of transforming our variable we can actually change the default <code>t.test()</code> argument by specifying <code>var.equal = FALSE</code>, which will then conduct a Welch t-test, which does not assume equal variances among groups.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="introduction-to-statistics.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(trout_clean<span class="sc">$</span>weight_g <span class="sc">~</span> trout_clean<span class="sc">$</span>section, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>While we used a slightly different method, our conclusions are still the same, finding that Cutthroat trout had significantly higher weights in clear cut forests than old growth.</p>
<div class="alert alert-info">
<p>Note: In the <code>t.test()</code> function you can add <code>paired = TRUE</code> to conduct a paired t-test. These are for cases when the groups are ‘paired’ for each observation, meaning each group/treatment was applied to the same individual, such as before and after experiments.</p>
</div>
</div>
<div id="correlation---assess-relationships" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Correlation - Assess relationships<a href="introduction-to-statistics.html#correlation---assess-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When you want to assess the relationship between two <strong>continuous variables</strong>, the test you would use is a correlation test. Correlation tests asses both the presence of a significant relationship along with the strength of that relationship (i.e., the correlation coefficient).</p>
<p>For our <code>and_vertebrates</code> data set, we can test length-mass relationships for our species with our length and weight continuous variables. Lets test the hypothesis that body length is positively correlated with weight, such that longer individuals will also weigh more, specifically looking at the Coastal Giant salamander.</p>
<p>First let’s clean our data set to just include the Coastal giant salamander and remove missing values for length and weight. Let’s focus on the variable ‘length_2_mm’ for snout to tail length.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="introduction-to-statistics.html#cb60-1" aria-hidden="true" tabindex="-1"></a>sally_clean <span class="ot">&lt;-</span> and_vertebrates <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="introduction-to-statistics.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">&quot;Coastal giant salamander&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="introduction-to-statistics.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(length_2_mm, weight_g)</span></code></pre></div>
<p>Now we can perform the correlation test with the <code>cor.test()</code> function. There are multiple correlation methods you can use with this function, by default it uses the Pearson correlation method. However this test assumes that your data is normally distributed and there is a linear relationship, so if that is not the case you can specify <code>spearman</code> for <code>method =</code> to use a Spearman Rank correlation test, a non-parametric test that is not sensitive to the variable distribution.</p>
<p>Let’s look at the distribution of these variables first:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="introduction-to-statistics.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sally_clean<span class="sc">$</span>length_2_mm)</span>
<span id="cb61-2"><a href="introduction-to-statistics.html#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="introduction-to-statistics.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sally_clean<span class="sc">$</span>weight_g)</span></code></pre></div>
<p>They both look pretty skewed, therefore likely not normally distributed. We can statistically test if a variable fits a normal distribution with the <code>shapiro.test()</code> function. However note that this function only runs for 5000 observations or less, so lets test for normally of the first 5000 obs of our <code>sally_clean</code> data set:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="introduction-to-statistics.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(sally_clean<span class="sc">$</span>length_2_mm[<span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span>])</span>
<span id="cb62-2"><a href="introduction-to-statistics.html#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="introduction-to-statistics.html#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(sally_clean<span class="sc">$</span>weight_g[<span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span>])</span></code></pre></div>
<p>The <em>null hypothesis of the Shapiro-Wilk normality test is that the variable is normally distributed</em>, so a significant p-value less than 0.05 (as we see for both of our variables here) tells use that our data does not fit a normal distribution.</p>
<p>Therefore we have two options as we did with our t-test example: transform the variables or use the non-parametric test.</p>
<p><strong>Variable transformation</strong></p>
<p>Lets try the first option by log transforming our variables (since we saw they both had pretty skewed distributions), first viewing the new distribution and then performing the Pearson’s correlation test (the default for <code>cor.test()</code>).</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="introduction-to-statistics.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(sally_clean<span class="sc">$</span>length_2_mm))</span>
<span id="cb63-2"><a href="introduction-to-statistics.html#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="introduction-to-statistics.html#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(sally_clean<span class="sc">$</span>weight_g))</span></code></pre></div>
<p>All we need to add to the <code>cor.test()</code> argument is the two variables of our <code>sally_clean</code> data set we want to test a relationship for, and let’s keep them log-transformed since those distributions looked closer to a normal distribution (visually at least).</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="introduction-to-statistics.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="fu">log</span>(sally_clean<span class="sc">$</span>length_2_mm), <span class="fu">log</span>(sally_clean<span class="sc">$</span>weight_g))</span></code></pre></div>
<p>Okay, from these results we see a very small p-value, meaning there is a significant association between the two, and a correlation coefficient of 0.98, representing a very strong, positive correlation.</p>
<p>Let’s look at this correlation visually:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="introduction-to-statistics.html#cb65-1" aria-hidden="true" tabindex="-1"></a>sally_clean <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="introduction-to-statistics.html#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(length_2_mm), <span class="at">y =</span> <span class="fu">log</span>(weight_g)))<span class="sc">+</span></span>
<span id="cb65-3"><a href="introduction-to-statistics.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p>We can use <code>geom_smooth()</code> to add a line of best fit using a linear model equation (which you will learn more about next week)</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="introduction-to-statistics.html#cb66-1" aria-hidden="true" tabindex="-1"></a>sally_clean <span class="sc">%&gt;%</span> </span>
<span id="cb66-2"><a href="introduction-to-statistics.html#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(length_2_mm), <span class="at">y =</span> <span class="fu">log</span>(weight_g)))<span class="sc">+</span></span>
<span id="cb66-3"><a href="introduction-to-statistics.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb66-4"><a href="introduction-to-statistics.html#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><strong>Spearman Correlation Test</strong></p>
<p>Let’s now perform the correlation test again but keeping our raw data and instead specifying <code>method = 'spearman'</code>, as the Spearman test is better for non-parametric and non-linear data sets.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="introduction-to-statistics.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(sally_clean<span class="sc">$</span>length_2_mm, sally_clean<span class="sc">$</span>weight_g, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<p>These results also represent a significant, positive relationship between length and weight for the Coastal Giant salamander, with a very high correlation coefficient.</p>
</div>
<div id="exercises-2" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Exercises<a href="introduction-to-statistics.html#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Each question requires you to carry out a statistical analysis to test some hypothesis related to the <code>and_vertebrates</code> data set. To answer each question fully:</p>
<ul>
<li><p>Include the code you used to clean the data and conduct the appropriate statistical test. (<em>Including the steps to assess and address your statistical test assumptions</em>).</p></li>
<li><p>Report the findings of your test in proper scientific format (with the p-value in parentheses).</p></li>
</ul>
<p><br></p>
<p><strong>1.</strong> Conduct a chi-square test similar to the one we carried out earlier in this lesson plan, but test for a relationship between forest type (<code>section</code>) and channel unit (<code>unittype</code>) for <em>Coastal giant salamander</em> abundance. <em>Keep all unittypes</em> instead of filtering any like we did for the Cutthroat trout (9 pts.)</p>
<p><br></p>
<p><strong>2.</strong> Test the hypothesis that there is a significant difference in species biomass between clear cut and old growth forest types for the <em>Coastal Giant salamander</em>. (8 pts.)</p>
<p><br></p>
<p><strong>3.</strong> Test the correlation between body length (snout to fork length) and body mass for <em>Cutthroat trout</em>. (Hint: run <code>?and_vertebrates</code> to find which length variable represents snout to fork length) (8 pts.)</p>
<p><br> <br></p>
<div id="acknowledgements" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Acknowledgements<a href="introduction-to-statistics.html#acknowledgements" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Thanks to the developers of <a href="https://lter.github.io/lterdatasampler/index.html"><code>lterdatasampler</code></a> for providing the data set and vignettes that helped guide the creation of this lesson plan.</p>
</div>
<div id="citations" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Citations<a href="introduction-to-statistics.html#citations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong><em>Data Source:</em></strong> Gregory, S.V. and I. Arismendi. 2020. Aquatic Vertebrate Population Study in Mack Creek, Andrews Experimental Forest, 1987 to present ver 14. Environmental Data Initiative. <a href="https://doi.org/10.6073/pasta/7c78d662e847cdbe33584add8f809165" class="uri">https://doi.org/10.6073/pasta/7c78d662e847cdbe33584add8f809165</a></p>
<p>Kaylor, M.J. and D.R. Warren. 2017. Linking riparian shade and the legacies of forest management to fish and vertebrate biomass in forested streams. Ecosphere <em>8</em>(6). <a href="https://doi.org/10.1002/ecs2.1845" class="uri">https://doi.org/10.1002/ecs2.1845</a></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exploratory-data-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariate-statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-univariate.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["quantitative-reasoning.pdf", "quantitative-reasoning.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
