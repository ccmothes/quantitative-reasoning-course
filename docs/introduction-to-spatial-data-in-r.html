<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 8 Introduction to Spatial Data in R | Quantitative Reasoning for Ecosystem Science</title>
  <meta name="description" content="This site hosts the course lab content for ESS 330 at Colorado State University." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content=" 8 Introduction to Spatial Data in R | Quantitative Reasoning for Ecosystem Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This site hosts the course lab content for ESS 330 at Colorado State University." />
  <meta name="github-repo" content="ccmothes/quantitative-reasoning-course" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 8 Introduction to Spatial Data in R | Quantitative Reasoning for Ecosystem Science" />
  
  <meta name="twitter:description" content="This site hosts the course lab content for ESS 330 at Colorado State University." />
  

<meta name="author" content="Caitlin C. Mothes, PhD" />


<meta name="date" content="2023-04-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pca-and-r-markdown-intro.html"/>
<link rel="next" href="data-visualization-in-r.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="libs/tabwid-1.1.2/tabwid.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Reasoning for Ecosystem Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#set-up-instructions"><i class="fa fa-check"></i>Set up Instructions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#navigating-this-site"><i class="fa fa-check"></i>Navigating this site</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="setup-instructions.html"><a href="setup-instructions.html"><i class="fa fa-check"></i><b>2</b> Setup Instructions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="setup-instructions.html"><a href="setup-instructions.html#install-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> Install R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="setup-instructions.html"><a href="setup-instructions.html#package-installation"><i class="fa fa-check"></i><b>2.2</b> Package Installation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>3</b> Introduction to R and RStudio</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#getting-to-know-rstudio"><i class="fa fa-check"></i><b>3.1</b> Getting to know RStudio</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#r-projects"><i class="fa fa-check"></i><b>3.2</b> R Projects</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#write-your-first-script"><i class="fa fa-check"></i><b>3.3</b> Write your first script</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#commenting-code"><i class="fa fa-check"></i><b>3.3.1</b> Commenting code</a></li>
<li class="chapter" data-level="3.3.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#executing-code"><i class="fa fa-check"></i><b>3.3.2</b> Executing code</a></li>
<li class="chapter" data-level="3.3.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#getting-help-with-code"><i class="fa fa-check"></i><b>3.3.3</b> Getting help with code</a></li>
<li class="chapter" data-level="3.3.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#functions"><i class="fa fa-check"></i><b>3.3.4</b> Functions</a></li>
<li class="chapter" data-level="3.3.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#data-types"><i class="fa fa-check"></i><b>3.3.5</b> Data Types</a></li>
<li class="chapter" data-level="3.3.6" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#indexing"><i class="fa fa-check"></i><b>3.3.6</b> Indexing</a></li>
<li class="chapter" data-level="3.3.7" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#read-and-write-data"><i class="fa fa-check"></i><b>3.3.7</b> Read and Write Data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#exercises"><i class="fa fa-check"></i><b>3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>4</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-wrangling"><i class="fa fa-check"></i><b>4.1</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#the-dplyr-package"><i class="fa fa-check"></i><b>4.1.1</b> The <code>dplyr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#visualization"><i class="fa fa-check"></i><b>4.2</b> Visualization</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exercises-1"><i class="fa fa-check"></i><b>4.2.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html"><i class="fa fa-check"></i><b>5</b> Introduction to Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#explore-the-dataset"><i class="fa fa-check"></i><b>5.1</b> Explore the dataset</a></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#chi-square---categorical-analysis"><i class="fa fa-check"></i><b>5.2</b> Chi-square - Categorical Analysis</a></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#t-test---compare-two-means"><i class="fa fa-check"></i><b>5.3</b> t-test - Compare two means</a></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#correlation---assess-relationships"><i class="fa fa-check"></i><b>5.4</b> Correlation - Assess relationships</a></li>
<li class="chapter" data-level="5.5" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#exercises-2"><i class="fa fa-check"></i><b>5.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#acknowledgements"><i class="fa fa-check"></i><b>5.5.1</b> Acknowledgements</a></li>
<li class="chapter" data-level="5.5.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#citations"><i class="fa fa-check"></i><b>5.5.2</b> Citations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html"><i class="fa fa-check"></i><b>6</b> Multivariate Statistics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#explore-the-data-set"><i class="fa fa-check"></i><b>6.1</b> Explore the Data set</a></li>
<li class="chapter" data-level="6.2" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#anova"><i class="fa fa-check"></i><b>6.2</b> ANOVA</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#assumptions"><i class="fa fa-check"></i><b>6.2.1</b> Assumptions</a></li>
<li class="chapter" data-level="6.2.2" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#post-hoc-tukeys-hsd-test"><i class="fa fa-check"></i><b>6.2.2</b> Post-hoc Tukey’s HSD test</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#simple-linear-regression"><i class="fa fa-check"></i><b>6.3</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="6.4" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#multiple-linear-regression"><i class="fa fa-check"></i><b>6.4</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="6.5" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#exercises-3"><i class="fa fa-check"></i><b>6.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#acknowledgements-1"><i class="fa fa-check"></i><b>6.5.1</b> Acknowledgements</a></li>
<li class="chapter" data-level="6.5.2" data-path="multivariate-statistics.html"><a href="multivariate-statistics.html#citations-1"><i class="fa fa-check"></i><b>6.5.2</b> Citations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html"><i class="fa fa-check"></i><b>7</b> PCA and R Markdown Intro</a>
<ul>
<li class="chapter" data-level="7.1" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#intro-to-r-markdown"><i class="fa fa-check"></i><b>7.1</b> Intro to R Markdown</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#getting-started-with-r-markdown"><i class="fa fa-check"></i><b>7.1.1</b> Getting started with R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#principal-component-analysis-pca"><i class="fa fa-check"></i><b>7.2</b> Principal Component Analysis (PCA)</a></li>
<li class="chapter" data-level="7.3" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#variance-explained"><i class="fa fa-check"></i><b>7.3</b> Variance explained</a></li>
<li class="chapter" data-level="7.4" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#variable-loadings"><i class="fa fa-check"></i><b>7.4</b> Variable loadings</a></li>
<li class="chapter" data-level="7.5" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#visualize-patterns"><i class="fa fa-check"></i><b>7.5</b> Visualize patterns</a></li>
<li class="chapter" data-level="7.6" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#a-note-on-rendering"><i class="fa fa-check"></i><b>7.6</b> A Note on Rendering:</a></li>
<li class="chapter" data-level="7.7" data-path="pca-and-r-markdown-intro.html"><a href="pca-and-r-markdown-intro.html#exercises-4"><i class="fa fa-check"></i><b>7.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html"><i class="fa fa-check"></i><b>8</b> Introduction to Spatial Data in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#set-up"><i class="fa fa-check"></i><b>8.1</b> Set Up</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#package-installation-1"><i class="fa fa-check"></i><b>8.1.1</b> Package Installation</a></li>
<li class="chapter" data-level="8.1.2" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#data-download"><i class="fa fa-check"></i><b>8.1.2</b> Data download</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#spatial-data-formats"><i class="fa fa-check"></i><b>8.2</b> Spatial Data Formats</a></li>
<li class="chapter" data-level="8.3" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#import-and-manipulate-spatial-data"><i class="fa fa-check"></i><b>8.3</b> Import and manipulate spatial data</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#vector-data"><i class="fa fa-check"></i><b>8.3.1</b> Vector Data</a></li>
<li class="chapter" data-level="8.3.2" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>8.3.2</b> Coordinate Reference Systems</a></li>
<li class="chapter" data-level="8.3.3" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#raster-data"><i class="fa fa-check"></i><b>8.3.3</b> Raster Data</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#reading-and-writing-spatial-data"><i class="fa fa-check"></i><b>8.4</b> Reading and Writing Spatial Data</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#writing-spatial-data"><i class="fa fa-check"></i><b>8.4.1</b> Writing spatial data</a></li>
<li class="chapter" data-level="8.4.2" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#reading-spatial-data"><i class="fa fa-check"></i><b>8.4.2</b> Reading Spatial Data</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#before-rendering"><i class="fa fa-check"></i><b>8.5</b> Before Rendering!</a></li>
<li class="chapter" data-level="8.6" data-path="introduction-to-spatial-data-in-r.html"><a href="introduction-to-spatial-data-in-r.html#exercises-5"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html"><i class="fa fa-check"></i><b>9</b> Data Visualization in R</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#data-preparation"><i class="fa fa-check"></i><b>9.0.1</b> Data Preparation</a></li>
<li class="chapter" data-level="9.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#publication-ready-figures-with-ggplot2"><i class="fa fa-check"></i><b>9.1</b> Publication Ready Figures with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#general-appearance"><i class="fa fa-check"></i><b>9.1.1</b> General Appearance</a></li>
<li class="chapter" data-level="9.1.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#color-size-and-legends"><i class="fa fa-check"></i><b>9.1.2</b> Color, Size and Legends</a></li>
<li class="chapter" data-level="9.1.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#annotation"><i class="fa fa-check"></i><b>9.1.3</b> Annotation</a></li>
<li class="chapter" data-level="9.1.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#finalize-and-save"><i class="fa fa-check"></i><b>9.1.4</b> Finalize and save</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#publication-ready-maps-with-tmap"><i class="fa fa-check"></i><b>9.2</b> Publication Ready Maps with <code>tmap</code></a></li>
<li class="chapter" data-level="9.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#publication-ready-tables-with-flextable"><i class="fa fa-check"></i><b>9.3</b> Publication Ready Tables with <code>flextable</code></a></li>
<li class="chapter" data-level="9.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#the-assignment"><i class="fa fa-check"></i><b>9.4</b> The Assignment</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#acknowledgements-and-resources"><i class="fa fa-check"></i><b>9.4.1</b> Acknowledgements and Resources</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Reasoning for Ecosystem Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-spatial-data-in-r" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number"> 8</span> Introduction to Spatial Data in R<a href="introduction-to-spatial-data-in-r.html#introduction-to-spatial-data-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="set-up" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Set Up<a href="introduction-to-spatial-data-in-r.html#set-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You will return this assignment similar to last week, by working through this lesson in an R Markdown document, answering the Exercises at the end, and knitting as a Word document to submit to Canvas.</p>
<p>Therefore, begin this lesson by creating a a new R Markdown document, and make sure to select output as Word.</p>
<div id="package-installation-1" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Package Installation<a href="introduction-to-spatial-data-in-r.html#package-installation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To carry out this lesson, you will need to install a couple new R packages to import and work with spatial data. The two main packages for working with spatial data are <code>sf</code> (<em>for vector data</em>) and <code>terra</code> (<em>for spatial data</em>). We will also be using <code>tmap</code> to visualize spatial data and make quick maps, along with the <code>tigris</code> package to import some vector data.</p>
<div class="alert alert-info">
<p>Run the following chunk of code in your console, comment it out, OR add <code>eval = FALSE</code> in the top of the code chunk. You do not want it to be included when you knit the R Markdown document, because it re-install the packages every time you knit.</p>
</div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="introduction-to-spatial-data-in-r.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>)</span>
<span id="cb104-2"><a href="introduction-to-spatial-data-in-r.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>)</span>
<span id="cb104-3"><a href="introduction-to-spatial-data-in-r.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tmap&quot;</span>)</span>
<span id="cb104-4"><a href="introduction-to-spatial-data-in-r.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tigris&quot;</span>)</span></code></pre></div>
<p>Now we need to read in these packages at the beginning of our workflow. You <strong>should</strong> have this as an executable code chunk in your R Markdown document.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="introduction-to-spatial-data-in-r.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb105-2"><a href="introduction-to-spatial-data-in-r.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb105-3"><a href="introduction-to-spatial-data-in-r.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb105-4"><a href="introduction-to-spatial-data-in-r.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb105-5"><a href="introduction-to-spatial-data-in-r.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tigris)</span></code></pre></div>
</div>
<div id="data-download" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Data download<a href="introduction-to-spatial-data-in-r.html#data-download" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Second, you will need to download an elevation raster file to carry out this lesson. If you haven’t already, in the R Project you have been using in this class, create a <code>data/</code> folder. Then, click the download button below, and save the file (elevation.tif) in the <code>data/</code> folder.</p>
<div class="callout-note">
<p><i class="bi bi-download"></i> <a href="data/elevation.tif" download="elevation.tif">Download elevation raster</a></p>
</div>
</div>
</div>
<div id="spatial-data-formats" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Spatial Data Formats<a href="introduction-to-spatial-data-in-r.html#spatial-data-formats" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Vector Data</strong></p>
<ul>
<li><p>Locations (points)</p>
<ul>
<li>Coordinates, address, country, city</li>
</ul></li>
<li><p>Shapes (lines or polygons)</p>
<ul>
<li>Political boundaries, roads, building footprints, water bodies</li>
</ul></li>
</ul>
<p><strong>Raster Data</strong></p>
<ul>
<li><p>Images (matrix of cells organized by rows and columns)</p>
<ul>
<li><p>Satellite imagery, climate, landcover, elevation</p>
<p><img src="images/spatial_formats.png" /></p></li>
</ul></li>
</ul>
</div>
<div id="import-and-manipulate-spatial-data" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Import and manipulate spatial data<a href="introduction-to-spatial-data-in-r.html#import-and-manipulate-spatial-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="vector-data" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Vector Data<a href="introduction-to-spatial-data-in-r.html#vector-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://github.com/walkerke/tigris"><strong><code>tigris</code></strong></a></p>
<p><strong>Polygons</strong></p>
<p>All the data we are working with in this lesson is confined to the state of Colorado. Let’s start by pulling in political boundaries for Colorado counties with the <code>tigris</code> package, which returns a shapefile consisting of polygons for each county.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="introduction-to-spatial-data-in-r.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># download county shapefile for the state of Colorado</span></span>
<span id="cb106-2"><a href="introduction-to-spatial-data-in-r.html#cb106-2" aria-hidden="true" tabindex="-1"></a>counties <span class="ot">&lt;-</span> <span class="fu">counties</span>(<span class="at">state =</span> <span class="st">&quot;CO&quot;</span>)</span></code></pre></div>
<p>The <code>tigris</code> package is one of many data retrieval R packages that uses API calls to pull in data from various online/open databases directly into your R session, without the need to separately download. When you close out your R session, these ‘temp’ files are erased, so it does not use up any of your local storage. At the end of this lesson you will learn how to save shapefiles to your computer if you do in fact want to store and use them in the future (e.g., you manipulated a data set quite a bit and don’t want to re-run the entire process every new R session).</p>
<p><strong>Lines</strong></p>
<p><code>tigris</code> has many other data sets in addition to political boundaries. Today let’s work with another shapefile, importing roads for Larimer county, which returns a polyline dataset for all roads in Larimer County.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="introduction-to-spatial-data-in-r.html#cb107-1" aria-hidden="true" tabindex="-1"></a>roads <span class="ot">&lt;-</span> <span class="fu">roads</span>(<span class="at">state =</span> <span class="st">&quot;CO&quot;</span>, <span class="at">county =</span> <span class="st">&quot;Larimer&quot;</span>)</span></code></pre></div>
<p><a href="https://r-tmap.github.io/tmap/"><strong><code>tmap</code></strong></a></p>
<p>Throughout this lesson we will be using the <code>tmap</code> package to produce quick static or interactive maps.</p>
<p><code>tmap</code> allows for both static (“plot” mode) and interactive (“view” mode) mapping options, which you can set using the function <code>tmap_mode()</code> . Lets start with making quick interactive plots. <strong>Once you set the mode with <code>tmap_mode()</code>, every plot call to <code>tmap</code> after that produces a plot in that mode.</strong></p>
<blockquote>
<p>Note: When you render this document to Word it will throw errors if you are trying to create interactive maps. <em>Before rendering</em> change “view” to “plot” in this code chunk.</p>
</blockquote>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="introduction-to-spatial-data-in-r.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;view&quot;</span>)</span></code></pre></div>
<p>Lets view our Colorado counties and Larimer County roads shapefiles. To make a “quick thematic map” in <code>tmap</code> you can use the <code>qtm()</code> function. You can also use <code>tm_shape()</code> plus the type of spatial layer (e.g., <code>tm_polygons()</code>) to add your layers to the map if you want to customize the map a little more. Notice how the two following chunks of code produce the same map, but <code>qtm()</code> is much more concise (but limited on customization abilities). Note that to add map elements we use <code>+</code>, similar to <code>ggplot</code> objects.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="introduction-to-spatial-data-in-r.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Using qtm</span></span>
<span id="cb109-2"><a href="introduction-to-spatial-data-in-r.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(counties)<span class="sc">+</span></span>
<span id="cb109-3"><a href="introduction-to-spatial-data-in-r.html#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qtm</span>(roads)</span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="introduction-to-spatial-data-in-r.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Using tm_shape</span></span>
<span id="cb110-2"><a href="introduction-to-spatial-data-in-r.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(counties)<span class="sc">+</span></span>
<span id="cb110-3"><a href="introduction-to-spatial-data-in-r.html#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()<span class="sc">+</span></span>
<span id="cb110-4"><a href="introduction-to-spatial-data-in-r.html#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(roads)<span class="sc">+</span></span>
<span id="cb110-5"><a href="introduction-to-spatial-data-in-r.html#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_lines</span>()</span></code></pre></div>
<p><em>Rendering the map may take a little while due to relatively large size of the <code>roads</code> object.</em></p>
<p>Mess around with this map a little bit. See that you can change the basemap, turn layers on and off, and click on features to see their attributes.</p>
<p>Let’s inspect the spatial data sets a little more. What do you see when you run the following line of code:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="introduction-to-spatial-data-in-r.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(counties)</span></code></pre></div>
<p><a href="https://r-spatial.github.io/sf/"><strong><code>sf</code></strong></a></p>
<p>By default, the <code>tigris</code> package imports spatial data in <code>sf</code> format, which stands for ‘simple features’. The <code>sf</code> package provides an easy and efficient way to work with vector data, and represents spatial features as a <code>data.frame</code> or <code>tibble</code> with a geometry column, and therefore also works well with <code>tidyverse</code> packages to perform manipulations like you would a data frame.</p>
<p>For example, we are going to do an exercise for the Poudre Canyon Highway, so we want to filter out the roads data set to only those features. Using our investigative geography skills, we find the Poudre highway on the map and find out the ‘FULLNAME’ attribute is “Poudre Canyon Hwy”. We can then use that knowledge to <code>filter()</code> the data set to just that highway:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="introduction-to-spatial-data-in-r.html#cb112-1" aria-hidden="true" tabindex="-1"></a>poudre_hwy <span class="ot">&lt;-</span> roads <span class="sc">%&gt;%</span> </span>
<span id="cb112-2"><a href="introduction-to-spatial-data-in-r.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FULLNAME <span class="sc">==</span> <span class="st">&quot;Poudre Canyon Hwy&quot;</span>)</span>
<span id="cb112-3"><a href="introduction-to-spatial-data-in-r.html#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="introduction-to-spatial-data-in-r.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(poudre_hwy)</span></code></pre></div>
<p><strong>Points</strong></p>
<p>Most often when you are working with points, you start with an excel file or something similar that consists of the raw geographic coordinates. When you have spatial data that is not explicitly spatial yet or not in the <code>sf</code> format, you use the <code>st_as_sf()</code> function to transform it.</p>
<p>Lets work with a couple locations along the Poudre highway, making a small data frame of their coordinates:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="introduction-to-spatial-data-in-r.html#cb113-1" aria-hidden="true" tabindex="-1"></a>poudre_points <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Mishawaka&quot;</span>, <span class="st">&quot;Rustic&quot;</span>, <span class="st">&quot;Blue Lake Trailhead&quot;</span>),</span>
<span id="cb113-2"><a href="introduction-to-spatial-data-in-r.html#cb113-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">long =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">105.35634</span>, <span class="sc">-</span><span class="fl">105.58159</span>, <span class="sc">-</span><span class="fl">105.85563</span>),</span>
<span id="cb113-3"><a href="introduction-to-spatial-data-in-r.html#cb113-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">lat =</span> <span class="fu">c</span>(<span class="fl">40.68752</span>, <span class="fl">40.69687</span>, <span class="fl">40.57960</span>))</span></code></pre></div>
<p>Now convert it to an <code>sf</code> object, specifying the longitude and latitude column names and the CRS (Coordinate Reference System). <strong>Note that ‘x’ (longitude) always goes first followed by ‘y’ (latitude) in the <code>coords =</code></strong> argument. We use the WGS84 CRS (EPSG code = 4326) here because I know the source CRS I retrieved the coordinates from, and also the GPS system often used to collect coordinates uses WGS84.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="introduction-to-spatial-data-in-r.html#cb114-1" aria-hidden="true" tabindex="-1"></a>poudre_points_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(poudre_points, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;long&quot;</span>, <span class="st">&quot;lat&quot;</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb114-2"><a href="introduction-to-spatial-data-in-r.html#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="introduction-to-spatial-data-in-r.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(poudre_hwy)<span class="sc">+</span></span>
<span id="cb114-4"><a href="introduction-to-spatial-data-in-r.html#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qtm</span>(poudre_points_sf)</span></code></pre></div>
</div>
<div id="coordinate-reference-systems" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Coordinate Reference Systems<a href="introduction-to-spatial-data-in-r.html#coordinate-reference-systems" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Probably the most important part of working with spatial data is the coordinate reference system (CRS) that is used. In order to analyze spatial data, all objects should be in the exact same CRS.</p>
<p>We can check a spatial object’s CRS by printing it to the console, which will return a bunch of metadata about the object. You can specifically return the CRS for <code>sf</code> objects with <code>st_crs()</code>.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="introduction-to-spatial-data-in-r.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see the CRS in the header metadata:</span></span>
<span id="cb115-2"><a href="introduction-to-spatial-data-in-r.html#cb115-2" aria-hidden="true" tabindex="-1"></a>counties</span>
<span id="cb115-3"><a href="introduction-to-spatial-data-in-r.html#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="introduction-to-spatial-data-in-r.html#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co">#return just the CRS (more detailed)</span></span>
<span id="cb115-5"><a href="introduction-to-spatial-data-in-r.html#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(counties)</span></code></pre></div>
<p>You can check if two <code>sf</code> objects have the same CRS like this:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="introduction-to-spatial-data-in-r.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(counties) <span class="sc">==</span> <span class="fu">st_crs</span>(poudre_points_sf)</span></code></pre></div>
<p>Uh oh, the CRS of our points and lines doesn’t match. While <code>tmap</code> performs some on-the-fly transformations to map the two layers together, in order to do any analyses with these objects you’ll need to re-project one of them. You can project an <code>sf</code> object’s CRS to that of another with <code>st_transform</code> like this:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="introduction-to-spatial-data-in-r.html#cb117-1" aria-hidden="true" tabindex="-1"></a>poudre_points_prj <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(poudre_points_sf, <span class="at">crs =</span> <span class="fu">st_crs</span>(counties))</span>
<span id="cb117-2"><a href="introduction-to-spatial-data-in-r.html#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="introduction-to-spatial-data-in-r.html#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Now check that they match</span></span>
<span id="cb117-4"><a href="introduction-to-spatial-data-in-r.html#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(poudre_points_prj) <span class="sc">==</span> <span class="fu">st_crs</span>(counties)</span></code></pre></div>
<p>You can also project an <code>sf</code> object’s CRS by specifying the EPSG code. <a href="https://epsg.io/">epsg.io</a> can help you find the appropriate EPSG code for your coordinate system.</p>
<p>For example, we know that <code>counties</code> is in NAD83 when we inspected the CRS above. The EPSG code for NAD83 is 4269, so we could also transform our points like this:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="introduction-to-spatial-data-in-r.html#cb118-1" aria-hidden="true" tabindex="-1"></a>poudre_points_prj <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(poudre_points_sf, <span class="at">crs =</span> <span class="dv">4269</span>)</span>
<span id="cb118-2"><a href="introduction-to-spatial-data-in-r.html#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="introduction-to-spatial-data-in-r.html#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Now check that they match</span></span>
<span id="cb118-4"><a href="introduction-to-spatial-data-in-r.html#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(poudre_points_prj) <span class="sc">==</span> <span class="fu">st_crs</span>(counties)</span></code></pre></div>
</div>
<div id="raster-data" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Raster Data<a href="introduction-to-spatial-data-in-r.html#raster-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Earlier in this lesson you downloaded a raster file for the elevation of Colorado. Make sure that file <code>elevation.tif</code> is in the <code>data/</code> folder of your R Project, and read the raster file in the <code>rast()</code> from the <code>terra</code> package like this:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="introduction-to-spatial-data-in-r.html#cb119-1" aria-hidden="true" tabindex="-1"></a>elevation <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">&quot;data/elevation.tif&quot;</span>)</span></code></pre></div>
<p>Make a quick plot to see the elevation layer:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="introduction-to-spatial-data-in-r.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(elevation)</span></code></pre></div>
<p>By default, <code>tmap</code> uses a categorical symbology to color the cells by elevation. You can change that to a continuous palette with <code>tm_raster()</code> like this:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="introduction-to-spatial-data-in-r.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(elevation)<span class="sc">+</span></span>
<span id="cb121-2"><a href="introduction-to-spatial-data-in-r.html#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Elevation (m)&quot;</span>)</span></code></pre></div>
<p>Let’s inspect this raster layer a little. By printing the object name to the console we see a bunch of metadata like resolution (cell size), extent, CRS, and file name.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="introduction-to-spatial-data-in-r.html#cb122-1" aria-hidden="true" tabindex="-1"></a>elevation</span></code></pre></div>
<p>We see that the CRS (<code>coord. ref.</code>) is in NAD83. We can also retrieve the CRS of raster objects with <code>crs()</code>.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="introduction-to-spatial-data-in-r.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(elevation)</span></code></pre></div>
<p>Since this matches the CRS of our vector data we can carry on with analysis without re-projecting. However, if you did want to transform a raster object to a different CRS you would use the <code>project()</code> function from the <code>terra</code> package.</p>
<p><strong><code>terra</code></strong></p>
<p>We can use the <code>terra</code> package to work with raster data. For example, say we only want to see elevation along the Poudre highway. We can use <code>crop</code> to crop the raster to the extent of our <code>poudre_hwy</code> object using the <code>ext()</code> function to get the extent of that spatial object.</p>
<blockquote>
<p>Note that ‘extent’ refers to the bounding box around a spatial object.</p>
</blockquote>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="introduction-to-spatial-data-in-r.html#cb124-1" aria-hidden="true" tabindex="-1"></a>elevation_crop <span class="ot">&lt;-</span> <span class="fu">crop</span>(elevation, <span class="fu">ext</span>(poudre_hwy))</span></code></pre></div>
<p>Lets make a final map with all the spatial data we created:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="introduction-to-spatial-data-in-r.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(elevation_crop)<span class="sc">+</span></span>
<span id="cb125-2"><a href="introduction-to-spatial-data-in-r.html#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qtm</span>(poudre_hwy)<span class="sc">+</span></span>
<span id="cb125-3"><a href="introduction-to-spatial-data-in-r.html#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qtm</span>(poudre_points_prj)</span></code></pre></div>
</div>
</div>
<div id="reading-and-writing-spatial-data" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Reading and Writing Spatial Data<a href="introduction-to-spatial-data-in-r.html#reading-and-writing-spatial-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="writing-spatial-data" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Writing spatial data<a href="introduction-to-spatial-data-in-r.html#writing-spatial-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All of the spatial data we’ve created are only saved as objects in our environment. To save the data to disk, the <code>sf</code> and <code>terra</code> packages have functions to do so. You are not required to save these files, but if you want to follow along with these functions save the data to the <code>data/</code> folder you created at the beginning of this lesson.</p>
<p>To save vector data with <code>sf</code>, use <code>write_sf()</code></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="introduction-to-spatial-data-in-r.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_sf</span>(poudre_hwy, <span class="st">&quot;data/poudre_hwy.shp&quot;</span>)</span>
<span id="cb126-2"><a href="introduction-to-spatial-data-in-r.html#cb126-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a href="introduction-to-spatial-data-in-r.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_sf</span>(poudre_points_prj, <span class="st">&quot;data/poudre_points.shp&quot;</span>)</span></code></pre></div>
<p>While you can give the file any name you want, note that <strong>you must put ‘.shp’ as the extension of the file</strong>.</p>
<p>After saving the above files, check your <code>data/</code> folder and notice the other auxiliary files saved with it (i.e., not just .shp). <strong>It is VERY important that whenever you share shapefiles, all the auxiliary files are saved with it, so often shapefiles are transferred via .zip folders</strong>. However, when reading shapefiles into R (<em>see below</em>) you only specify the file with the ‘.shp’ extension. As long as all the other auxiliary files are saved in that same folder, it will read in the shapefile correctly.</p>
<p>To save raster data with <code>terra</code> use <code>writeRaster()</code></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="introduction-to-spatial-data-in-r.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(elevation_crop, <span class="st">&quot;data/elevation_crop.tif&quot;</span>)</span></code></pre></div>
<p>Same as with the vector data, when saving raster data you must add the ‘.tif’ file extension to the name. There are various formats raster data can be stored as (e.g., ASCII, ESRI Grid) but GeoTiffs are the most common and generally easiest to deal with in R.</p>
</div>
<div id="reading-spatial-data" class="section level3 hasAnchor" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Reading Spatial Data<a href="introduction-to-spatial-data-in-r.html#reading-spatial-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To read in shapefiles, you use <code>read_sf()</code> . <em>Note that this line of code will only run if you’ve saved your poudre_hwy object above with <code>write_sf()</code>.</em></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="introduction-to-spatial-data-in-r.html#cb128-1" aria-hidden="true" tabindex="-1"></a>poudre_hwy <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">&quot;data/poudre_hwy.shp&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="before-rendering" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Before Rendering!<a href="introduction-to-spatial-data-in-r.html#before-rendering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before rendering this assignment to a Word document, remember Word does not work with any interactive visualizations. Therefore, go back to the beginning of your workflow where you set <code>tmap_mode()</code>, and instead change it to static plotting with <code>tmap_mode("plot")</code> OR comment out <code>tmap_mode("view")</code> as the default is “plot” mode.</p>
</div>
<div id="exercises-5" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Exercises<a href="introduction-to-spatial-data-in-r.html#exercises-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Answer the following questions in your R Markdown document (also paste the questions above each answer). When your R Markdown document is complete, render it to a Word document and upload that to Canvas.</p>
<p><strong>1.</strong> Filter out the <code>counties</code> data set to only include Larimer, Denver, and Pueblo counties. (6 pts.)</p>
<p><strong>2.</strong> Lets look at the attributes for each county in our <code>counties</code> dataset:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="introduction-to-spatial-data-in-r.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(counties)</span></code></pre></div>
<p>We have one variable in here <code>AWATER</code> that is the total area of surface water each county has. Say you want to spatially visualize the variation in surface water area among counties. Looking at the arguments you can use in <code>qtm()</code>:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="introduction-to-spatial-data-in-r.html#cb130-1" aria-hidden="true" tabindex="-1"></a>?qtm</span></code></pre></div>
<p>There is an argument <code>fill =</code>, where we can specify a variable in the dataset to color the polygons by. Use <code>qtm()</code> to make a map of <code>counties</code> that is colored by <code>AWATER</code>. Which county has the largest area of surface water? (7 pts.)</p>
<p><strong>3.</strong> Write two lines of code to retrieve the CRS from 1) <code>poudre_hwy</code> and 2) <code>elevation</code>. (5 pts.)</p>
<p><strong>4.</strong> <code>extract()</code> is a function in the <code>terra</code> package to extract raster values at specified spatial features. Run the following line of code, which will add a new column to <code>poudre_points_prj</code> called <code>elevation</code> that is the extracted elevation at each site.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="introduction-to-spatial-data-in-r.html#cb131-1" aria-hidden="true" tabindex="-1"></a>poudre_points_prj<span class="sc">$</span>elevation <span class="ot">&lt;-</span>  <span class="fu">extract</span>(elevation, poudre_points_prj)[,<span class="dv">2</span>]</span></code></pre></div>
<p>Then, make a barplot that compares the elevation at each of the 3 sites. <em>Hint : look into the use of <code>geom_col()</code></em> <em>as opposed to <code>geom_bar()</code>.</em> Which site has the highest elevation? (7 pts).</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pca-and-r-markdown-intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-visualization-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/07-spatial.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["quantitative-reasoning.pdf", "quantitative-reasoning.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
